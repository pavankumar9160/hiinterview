<!doctype html>
<html lang="en" class="h-full">
<head>
 <meta charset="utf-8" />
 <meta name="viewport" content="width=device-width,initial-scale=1" />
 <title>Sign In / Sign Up — Hi Interviews</title>
 <meta name="robots" content="noindex, nofollow" />
 <link rel="preconnect" href="https://fonts.googleapis.com" />
 <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
 <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@500;600;700&family=Inter:wght@300;400;600&display=swap" rel="stylesheet" />
 <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
 <script src="https://cdn.tailwindcss.com"></script>
 <script src="https://code.jquery.com/jquery-3.7.1.min.js" crossorigin="anonymous"></script>

 <style>
 :root{
 --brand-50:#eef2ff; --brand-100:#e0e7ff; --brand-300:#a5b4fc; --brand-500:#6366f1; --brand-600:#4f46e5;
 --ink-900:#0f172a; --muted:#64748b;
 }
 html,body { height:100%; }
 body {
 font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
 background: linear-gradient(180deg, rgba(79,70,229,0.04) 0%, rgba(139,92,246,0.02) 100%);
 color: var(--ink-900);
 -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
 }
 .auth-wrap{ max-width:1100px; margin:auto; padding:40px 20px; }
 .card { border-radius:14px; overflow:hidden; box-shadow: 0 20px 50px rgba(15,23,42,0.06); background: linear-gradient(180deg, rgba(255,255,255,0.86), rgba(255,255,255,0.9)); border:1px solid rgba(16,24,40,0.04); }
 .left-panel { background: linear-gradient(180deg, rgba(99,102,241,0.06), rgba(79,70,229,0.02)); padding:36px; }
 .right-panel { padding:34px; }
 .brand-badge{ width:52px;height:52px;border-radius:12px;background:linear-gradient(180deg,var(--brand-600),var(--brand-500)); color:white; display:flex;align-items:center;justify-content:center;font-weight:700;font-family:Poppins; }
 .muted{ color:var(--muted); }
 .brand-btn{ background: linear-gradient(90deg,var(--brand-500),var(--brand-600)); box-shadow: 0 10px 30px rgba(79,70,229,0.12); }
 .input { border:1px solid rgba(16,24,40,0.06); background:white; height:48px; padding:0 12px; border-radius:10px; }
 .pw-strength { height:8px; border-radius:8px; background:rgba(15,23,42,0.04); overflow:hidden; }
 .pw-fill { height:100%; width:0%; transition: width .28s ease; background:linear-gradient(90deg,#f97316,#10b981); }
 .toggle-link{ color:var(--brand-600); cursor:pointer; font-weight:600; }
 .small { font-size:0.86rem; }
 @media (max-width:1024px){
 .layout-grid { grid-template-columns: 1fr; }
 .left-panel { display:none; }
 .auth-wrap{ padding:20px; }
 }
 </style>
</head>

<body>
 <div class="auth-wrap">
 <div class="card layout-grid grid grid-cols-2">
 <!-- Left: Branding & motivation -->
 <div class="left-panel">
 <div class="flex items-start gap-4">
 <div class="brand-badge">HI</div>
 <div>
 <div class="text-xl font-semibold">Hi Interviews</div>
 <div class="text-sm muted">Partner Portal</div>
 </div>
 </div>

 <h1 class="mt-8 text-3xl font-bold">Grow your earnings — one referral at a time</h1>
 <p class="mt-3 muted small max-w-lg">Join a community of partners helping job seekers succeed. Share short links, earn reliably, and withdraw when you need. We handle payouts so you can focus on what matters.</p>

 <div class="mt-8 space-y-4">
 <div class="flex items-start gap-3">
 <div class="w-10 h-10 rounded-lg flex items-center justify-center bg-white/90 border border-white/50 text-brand-600"><i class="fa-solid fa-rocket"></i></div>
 <div>
 <div class="font-semibold">Scale quickly</div>
 <div class="muted small">Simple links, clear commissions</div>
 </div>
 </div>
 <div class="flex items-start gap-3">
 <div class="w-10 h-10 rounded-lg flex items-center justify-center bg-white/90 border border-white/50 text-accent-iris"><i class="fa-solid fa-hand-holding-dollar"></i></div>
 <div>
 <div class="font-semibold">Get paid reliably</div>
 <div class="muted small">Auto payouts & instant withdrawals</div>
 </div>
 </div>
 <div class="flex items-start gap-3">
 <div class="w-10 h-10 rounded-lg flex items-center justify-center bg-white/90 border border-white/50 text-brand-600"><i class="fa-solid fa-headset"></i></div>
 <div>
 <div class="font-semibold">Partner support</div>
 <div class="muted small">Dedicated help when you need it</div>
 </div>
 </div>
 </div>

 <div class="mt-10 small muted">“Every referral creates a ripple — keep building momentum.”</div>
 <div class="mt-6 small muted">Need help? <a href="tel:+911234567890" class="toggle-link">+91 12345 67890</a></div>
 </div>

 <!-- Right: Forms -->
 <div class="right-panel">
 <div class="max-w-md mx-auto">
 <div class="flex items-center justify-between mb-4">
 <h2 id="formTitle" class="text-2xl font-semibold">Sign in</h2>
 <div class="small muted">New here? <span id="switchToSignup" class="toggle-link">Create account</span></div>
 </div>

 <!-- Email sign-in compact -->
 <form id="signInForm" class="space-y-4">
 <div>
 <label class="small muted">Email or contact</label>
 <input id="loginIdentifier" class="input w-full mt-2" placeholder="name@example.com or +91XXXXXXXXXX" />
 </div>

 <div>
 <label class="small muted">Password</label>
 <div class="relative mt-2">
 <input id="loginPassword" type="password" class="input w-full pr-10" placeholder="Enter your password" />
 <button type="button" id="toggleLoginPw" class="absolute right-3 top-2.5 text-muted"><i class="fa-regular fa-eye"></i></button>
 </div>
 </div>

 <div class="flex items-center justify-between small muted">
 <label class="flex items-center gap-2"><input id="rememberMe" type="checkbox" /> Remember me</label>
 <a id="forgotLink" class="toggle-link">Forgot?</a>
 </div>

 <div>
 <button type="submit" class="w-full py-3 rounded-lg text-white brand-btn">Sign in</button>
 </div>
 </form>

 <!-- Sign Up form (hidden) -->
 <form id="signUpForm" class="space-y-4 hidden">
 <div class="grid grid-cols-2 gap-3">
 <div>
 <label class="small muted">First name</label>
 <input id="suFirst" class="input mt-2 w-full" placeholder="First name" />
 </div>
 <div>
 <label class="small muted">Last name</label>
 <input id="suLast" class="input mt-2 w-full" placeholder="Last name" />
 </div>
 </div>

 <div>
 <label class="small muted">Email</label>
 <input id="suEmail" class="input mt-2 w-full" placeholder="name@example.com" />
 </div>

 <div>
 <label class="small muted">Contact</label>
 <input id="suContact" class="input mt-2 w-full" placeholder="+91XXXXXXXXXX" />
 </div>

 <div class="grid grid-cols-2 gap-3">
 <div>
 <label class="small muted">Create password</label>
 <div class="relative mt-2">
 <input id="suPass" type="password" class="input w-full pr-10" placeholder="At least 8 characters" />
 <button type="button" class="absolute right-3 top-2.5 text-muted toggle-pw"><i class="fa-regular fa-eye"></i></button>
 </div>
 </div>
 <div>
 <label class="small muted">Confirm password</label>
 <div class="relative mt-2">
 <input id="suPass2" type="password" class="input w-full pr-10" placeholder="Confirm password" />
 <button type="button" class="absolute right-3 top-2.5 text-muted toggle-pw2"><i class="fa-regular fa-eye"></i></button>
 </div>
 </div>
 </div>

 <div>
 <label class="small muted">Date of birth</label>
 <input id="suDob" type="date" class="input mt-2 w-full" />
 </div>

 <div>
 <div class="small muted mb-2">Password strength</div>
 <div class="pw-strength"><div id="pwFill" class="pw-fill"></div></div>
 <div id="pwHelp" class="small muted mt-1">Use 8+ characters, mix of letters & numbers.</div>
 </div>

 <div class="flex items-center gap-2 small muted">
 <input id="acceptTos" type="checkbox" /> <div>I agree to Hi Interviews <a class="toggle-link">Terms</a> & <a class="toggle-link">Privacy</a>.</div>
 </div>

 <div class="flex gap-3">
 <button id="createAccountBtn" type="submit" class="flex-1 py-3 rounded-lg text-white brand-btn">Create account</button>
 <button id="cancelSignup" type="button" class="px-4 py-3 rounded-lg border border-gray-100">Cancel</button>
 </div>
 </form>

 <div id="formFooter" class="mt-6 text-center small muted">
 By continuing you agree to our partner terms. We value your work and will always pay promptly.
 </div>

 <div id="authMsg" class="mt-4 text-center text-sm text-green-600 hidden"></div>
 </div>
 </div>
 </div>
 </div>

 <!-- toast root -->
 <div id="toastRoot" class="fixed right-6 bottom-6 z-50"></div>

<script>
(function($){
 'use strict';

 // small helpers
 function toast(msg, ms=1600){
 const $t = $('<div>').addClass('bg-ink-900 text-black px-4 py-2 rounded-lg shadow-lg').text(msg).css({opacity:0});
 $('#toastRoot').append($t); $t.animate({opacity:1},200);
 setTimeout(()=>{$t.fadeOut(240,()=>$t.remove());},ms);
 }
 function validateEmail(e){ return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test((e||'').trim()); }
 function validateContact(c){ return /^\+?\d{10,14}$/.test((c||'').trim()); }
 function pwStrength(p){
 let score = 0;
 if(p.length >= 8) score++;
 if(/[0-9]/.test(p)) score++;
 if(/[A-Z]/.test(p)) score++;
 if(/[^A-Za-z0-9]/.test(p)) score++;
 return score;
 }
 function escapeHtml(t){ return String(t||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

 // toggle forms
 function showSignIn(){ $('#formTitle').text('Sign in'); $('#signUpForm').hide(); $('#signInForm').show(); $('#switchToSignup').text('Create account'); }
 function showSignUp(){ $('#formTitle').text('Create account'); $('#signInForm').hide(); $('#signUpForm').show(); $('#switchToSignup').text('Have an account? Sign in'); }
 showSignIn();

 $('#switchToSignup').on('click', function(){ $('#signUpForm').is(':visible') ? showSignIn() : showSignUp(); });

 // password toggles
 $('#toggleLoginPw').on('click', function(){ const $pw = $('#loginPassword'); const t = $pw.attr('type') === 'password' ? 'text' : 'password'; $pw.attr('type', t); $(this).find('i').toggleClass('fa-eye fa-eye-slash'); });
 $('.toggle-pw').on('click', function(){ const $pw = $('#suPass'); const t = $pw.attr('type') === 'password' ? 'text' : 'password'; $pw.attr('type', t); $(this).find('i').toggleClass('fa-eye fa-eye-slash'); });
 $('.toggle-pw2').on('click', function(){ const $pw = $('#suPass2'); const t = $pw.attr('type') === 'password' ? 'text' : 'password'; $pw.attr('type', t); $(this).find('i').toggleClass('fa-eye fa-eye-slash'); });

 // strength bar
 $('#suPass').on('input', function(){
 const p = $(this).val() || '';
 const s = pwStrength(p);
 const pct = (s / 4) * 100;
 $('#pwFill').css('width', pct + '%');
 if(s <= 1) $('#pwFill').css('background','linear-gradient(90deg,#ef4444,#f97316)');
 else if(s === 2) $('#pwFill').css('background','linear-gradient(90deg,#f59e0b,#f97316)');
 else if(s === 3) $('#pwFill').css('background','linear-gradient(90deg,#f59e0b,#10b981)');
 else $('#pwFill').css('background','linear-gradient(90deg,#10b981,#059669)');
 });

 // sign up
 $('#signUpForm').on('submit', async function(e){
 e.preventDefault();
 const first = $('#suFirst').val().trim();
 const last = $('#suLast').val().trim();
 const email = $('#suEmail').val().trim().toLowerCase();
 const contact = $('#suContact').val().trim();
 const pass = $('#suPass').val();
 const pass2 = $('#suPass2').val();
 const dob = $('#suDob').val();
 const tos = $('#acceptTos').is(':checked') === "true"? "True" : "False";

 if(!first) return toast('Enter first name');
 if(!email || !validateEmail(email)) return toast('Enter valid email');
 if(!contact || !validateContact(contact)) return toast('Enter valid contact');
 if(pass.length < 8) return toast('Password must be at least 8 characters');
 if(pass !== pass2) return toast("Passwords don't match");
 if(!tos) return toast('Please accept terms');

                const formData = new FormData();
                formData.append("first_name", first);
                formData.append("last_name", last);
                formData.append("dob", dob);
                formData.append("email", email);
                formData.append("password", pass);
                formData.append("password2", pass2);
                formData.append('mobile',contact);
                formData.append("tos", tos);

                try {
                    const response = await fetch("http://127.0.0.1:8000/api/partner/signup/", {
                        method: "POST",
                        body: formData 
                    });

                    if (response.ok) {
                        const result = await response.json();
                        console.log("Signup success:", result);
                        localStorage.clear();
                        sessionStorage.clear();
                        alert("Application submitted successfully!");
                        $('#authMsg').removeClass('hidden').text('Account created — you can sign in now.');
                        toast('Account created');
                        setTimeout(()=>{ showSignIn(); $('#loginIdentifier').val(email); $('#loginPassword').focus(); }, 700);
                    } else {
                        const errorData = await response.json();
                        console.error("Error:", errorData);
                        alert("Error submitting form.");
                    }
                } catch (err) {
                    console.error("Request failed:", err);
                }

 });

 // sign in
 $('#signInForm').on('submit', async function(e){
 e.preventDefault();
 const email_or_mobile = $('#loginIdentifier').val().trim().toLowerCase();
 const password = $('#loginPassword').val();
 const rememberMe = $('#rememberMe').checked


 if(!email_or_mobile) return toast('Enter email or contact');
 if(!password) return toast('Enter password');

               if (!email_or_mobile || !password ) {
                    alert("please enter email and password");
                    return;
                }
              
                localStorage.clear();
                sessionStorage.clear();


               
                try {
                    const response = await fetch('http://127.0.0.1:8000/api/partner/login/', {
                        method: "POST",
                         headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({email_or_mobile:email_or_mobile,password:password})
                    });

                    const data = await response.json();

                    if (response.ok) {
                        
                        alert(data.message);

                        if (rememberMe) {
                            localStorage.setItem('accessToken', data.access);
                            localStorage.setItem('refreshToken', data.refresh);
                            localStorage.setItem('role',data.role);
                        } else {
                            sessionStorage.setItem('accessToken', data.access);
                            sessionStorage.setItem('refreshToken', data.refresh);
                             sessionStorage.setItem('role', data.role);
                        }
                     const $m = $(`
                        <div style="width:360px;background:white;border-radius:12px;padding:18px;box-shadow:0 20px 50px rgba(16,24,40,0.08);">
                        <div style="display:flex;justify-content:space-between;align-items:center">
                        <div><strong>Welcome, ${escapeHtml(data.first_name)}</strong><div style="font-size:12px;color:#64748b">Signed in as partner</div></div>
                        <button id="closeWelcome" style="background:transparent;border:none;font-size:18px;color:#94a3b8">×</button>
                        </div>
                        <div style="margin-top:12px;font-size:13px;color:#475569">This is a demo — implement a redirect to your dashboard. Clicking continue will close this message.</div>
                        <div style="margin-top:14px;text-align:right"><button id="goDashboard" style="padding:8px 12px;border-radius:8px;background:linear-gradient(90deg,#6366f1,#4f46e5);color:white;border:none">Continue</button></div>
                        </div>
                        `);
                        openModal($m);
                        $m.on('click', '#closeWelcome', closeModal);
                        $m.on('click', '#goDashboard', function(){ toast('Redirecting...'); setTimeout(()=>{ closeModal();  location.href = 'partner-dashboard.html' },600); });    
                                        
                    } else if (response.status=== 401){
                        alert(data.message || "Something went wrong");
                    }
                } catch (error) {
                    console.error("Error:", error);
                    alert("An error occurred while Login.");
                }
      
 });

 // forgot
 $('#forgotLink').on('click', function(){
 const email = $('#loginIdentifier').val().trim().toLowerCase();
 if(!email || !validateEmail(email)) return toast('Enter registered email');
 const $m = $(`
 <div style="width:360px;background:white;border-radius:12px;padding:18px;box-shadow:0 20px 50px rgba(16,24,40,0.08);">
 <div style="display:flex;justify-content:space-between;align-items:center"><div><strong>Reset password</strong></div><button id="closeReset" style="background:transparent;border:none;color:#94a3b8">×</button></div>
 <div style="margin-top:12px;font-size:13px;color:#475569">A reset email has been sent to <strong>${escapeHtml(email)}</strong> (demo).</div>
 <div style="margin-top:14px;text-align:right"><button id="okReset" style="padding:8px 12px;border-radius:8px;background:#eef2ff;color:#4f46e5;border:none">Close</button></div>
 </div>
 `);
 openModal($m);
 $m.on('click','#closeReset,#okReset', closeModal);
 });

 // modal helpers
 function openModal($content){
 const $back = $('<div>').attr('id','_backdrop').css({position:'fixed',inset:0,background:'rgba(2,6,23,0.45)',zIndex:9998}).appendTo('body');
 const $box = $('<div>').attr('id','_dialog').css({position:'fixed',left:'50%',top:'50%',transform:'translate(-50%,-50%)',zIndex:9999}).appendTo('body');
 $box.append($content);
 function closeAll(){ $back.remove(); $box.remove(); }
 $back.on('click', closeAll);
 window._closeAuthModal = closeAll;
 }
 function closeModal(){ if(window._closeAuthModal) window._closeAuthModal(); }

 // cancel signup
 $('#cancelSignup').on('click', function(){ showSignIn(); });

 // prefill last login (demo)
 $(function(){ try{ const last = localStorage.getItem('hi_last_login_identifier'); if(last) $('#loginIdentifier').val(last); }catch(e){} });

})(jQuery);
</script>
</body>
</html>